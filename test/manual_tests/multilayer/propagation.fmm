# Field propagation through a stratified medium.
#
# See M. Born, E. Wolf "Principle of Optics"
# Seventh edition, Cambridge University Press, 1999
# table 1.3, page 74.

size 1e-6 1e-6

# Since only the normal incidence is calculated, this is enough
harmonics 1 1

# Visible, green
let lambda0=5460e-10

wavelength lambda0

let n2=2.3	# Zinc sulphide.
let n3=1.35 # Cryolite.

# Quarter wavelength layers.
let h2=lambda0/4/n2
let h3=lambda0/4/n3

let N=1		

section 10e-6
	substrate 1.0 0.0

section h2
 		substrate n2 0.0
 		
for :t 0 N 1
	
	section h3
		substrate n3 0.0
		
	section h2
 		substrate n2 0.0
	
	
next :t
	
section 10e-6
	substrate 1.52 0.0

wants propagation
solve

assemble 
excitation f cx 1.0 0.0 
propagation Ex m 100e-9 1 1 prop.txt

select 1

# Since there is only a single eigenvalue, the norm will be equal to the
# coefficient of this eigenvalue.

norm f
norm b

# The value of R_{2N+1} will be the square of the ratio of the two coefficients



